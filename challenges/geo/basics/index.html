<!DOCTYPE html>
<html>
  <head>
    <title>Workshop Mapping with D3 - Challenges - D3 Geo - Basics</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <meta content='width=device-width, initial-scale=1.0' name='viewport'>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" /><link href="https://fonts.googleapis.com/css?family=Lato:100,300,400,700,900,100italic,300italic,400italic,700italic,900italic|Montserrat:400,700" rel="stylesheet" type="text/css" />
    <link href="/mapping_with_d3_foss4g_2017/stylesheets/leadpage.css" rel="stylesheet" type="text/css" /><link href="/mapping_with_d3_foss4g_2017/stylesheets/code.css" rel="stylesheet" type="text/css" />
    <link href='/images/favicon.ico' rel='icon'>
    <script src="//d3js.org/d3.v4.js" type="text/javascript"></script><script src="//code.jquery.com/jquery-2.1.4.min.js" type="text/javascript"></script><script src="/mapping_with_d3_foss4g_2017/javascripts/challenges.js" type="text/javascript"></script><script src="//static.jsbin.com/js/embed.min.js?4.0.4" type="text/javascript"></script>
    <div class='nav fixed'>
      <div class='nav-content'>
        <div class='logo-container'>
          <a href="https://civicvision.de"><img alt="Civic Vision" height="30" class="logo" src="/mapping_with_d3_foss4g_2017/images/logo_white.png" />
          <h4>Open Data Consultancy for social good</h4>
          </a>
        </div>
        <h2>Workshop - Mapping with d3</h2>
        <ul class='nav-small'>
          <li>
            <a href="/mapping_with_d3_foss4g_2017/presentation/">Presentation</a>
          </li>
          <li>
            <a href="/mapping_with_d3_foss4g_2017/challenges/basics/">D3 Basics</a>
          </li>
          <li>
            <a href="/mapping_with_d3_foss4g_2017/challenges/geo/">D3 Mapping</a>
          </li>
        </ul>
      </div>
    </div>
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MTT6KM"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>
      var _dcq = _dcq || [];
      var _dcs = _dcs || {};
      _dcs.account = "4828671";
      (function() {
      	var dc = document.createElement('script');
      	dc.type = 'text/javascript'; dc.async = true;
      	dc.src = "//tag.getdrip.com/4828671.js";
      	var s = document.getElementsByTagName('script')[0];
      	s.parentNode.insertBefore(dc, s);
      })();
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer',"GTM-MTT6KM");
    </script>
  </head>
  <div class='login-required'></div>
  <div id='landingpage'>
    <section class='sub-heading'>
      <div class='content-wrapper'>
        <h1>Basics</h1>
        <h2>How to create a simple (ugly) map.</h2>
        <p>Remember the <code>path</code> SVG element from the introduction? It will be useful here. What did we need to use it again? Right, the <code>d</code> attribute.<br>
        If you want to understand the <code>d</code> attribute in more detail take a look at the <a href="https://www.w3schools.com/graphics/svg_path.asp">Reference</a></p>
        <pre class="highlight html"><code><span class="nt">&lt;path</span> <span class="na">d=</span><span class="s">"M150 0 L75 200 L225 200 Z"</span><span class="nt">&gt;&lt;/path&gt;</span>&#x000A;&#x000A;</code></pre>
        <h4>Introducing the first helper: geoPath</h4>
        
        <p>The <code>d3.geoPath()</code> helper function, given a GeoJSON geometry or feature object, generates an SVG path data string or renders the path to a Canvas.<br>
        <a href="https://github.com/d3/d3-geo#paths">Reference</a></p>
        <pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">geojson</span> <span class="o">=</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="s1">'Point'</span><span class="p">,</span> <span class="na">coordinates</span><span class="p">:</span> <span class="p">[</span><span class="mf">42.3132882</span><span class="p">,</span><span class="o">-</span><span class="mf">71.1972416</span><span class="p">]};</span>&#x000A;<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">geoPath</span><span class="p">()(</span><span class="nx">geojson</span><span class="p">))</span>&#x000A;<span class="o">&gt;</span> <span class="s2">"M42.3132882,-71.1972416m0,4.5a4.5,4.5 0 1,1 0,-9a4.5,4.5 0 1,1 0,9z"</span>&#x000A;&#x000A;</code></pre>
        <p>To add a point to an SVG use the following:</p>
        <pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">point</span> <span class="o">=</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="s1">'Point'</span><span class="p">,</span> <span class="na">coordinates</span><span class="p">:</span> <span class="p">[</span><span class="mf">42.3132882</span><span class="p">,</span><span class="o">-</span><span class="mf">71.1972416</span><span class="p">]};</span>&#x000A;<span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">'path'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geoPath</span><span class="p">()(</span><span class="nx">point</span><span class="p">));</span>&#x000A;<span class="c1">//or</span>&#x000A;<span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">'path'</span><span class="p">).</span><span class="nx">datum</span><span class="p">(</span><span class="nx">point</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geoPath</span><span class="p">());</span>&#x000A;&#x000A;</code></pre>
        <p>You can create either one big <code>path</code> element, or if oyu want to style or add interaction you can use multiple path elements. This is typically slower.</p>
        
        <h4>Projection</h4>
        
        <p>To really create a map we all know, you need to add a projection to the path. We will go deeper into projections later on, so bear with me.</p>
        <pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">projection</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geoAlbers</span><span class="p">();</span>&#x000A;&#x000A;<span class="kd">var</span> <span class="nx">pathGenerator</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geoPath</span><span class="p">()</span>&#x000A;  <span class="p">.</span><span class="nx">projection</span><span class="p">(</span><span class="nx">projection</span><span class="p">);</span>&#x000A;&#x000A;</code></pre>
        <h3>Example</h3>
        <p>Combining all these elements, we can create our first map.</p>
        <a class='jsbin-embed' href='http://jsbin.com/hexemer/embed?js,output'>D3 Selection on jsbin.com</a>
        <p>A neat feature we used here is the <code>projection.fitExtent([[20, 20], [600, 600]], geojson)</code> which will fit the map to the extent of the geojson we provide. We provide a padding <code>[20,20]</code> and the width and height of the map <code>[600,600]</code></p>
        
        <blockquote>
        <p><code>fitExtent()</code>: Sets the projection’s scale and translate to fit the specified GeoJSON object in the center of the given extent. The extent is specified as an array [[x₀, y₀], [x₁, y₁]], where x₀ is the left side of the bounding box, y₀ is the top, x₁ is the right and y₁ is the bottom. Returns the projection.</p>
        </blockquote>
        
        <p><a href="https://github.com/d3/d3-geo#projection_fitExtent">Reference</a></p>
        <h3>Tips for the Excercises</h3>
        <p>You might want to check out the SVG reference to get to know SVG a little more. You need certain attributes to change the color. <a href="https://www.w3schools.com/graphics/svg_inhtml.asp">Reference</a></p>
        
        <h4>Where do I find good colors?</h4>
        
        <p>Check out <a href="colorbrewer2.org">Colorbrewer</a>. An awesome tool and it can generate javascript arrays for you :)</p>
        
        <p>Or use d3 internal color tools. It will create a method which returns 10 colors. It uses a Scale internally. </p>
        <pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scaleOrdinal</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">schemeCategory10</span><span class="p">);</span>&#x000A;<span class="nx">color</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>&#x000A;<span class="o">&gt;</span> <span class="err">#</span><span class="mi">1</span><span class="nx">f77b4</span>&#x000A;<span class="nx">color</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>&#x000A;<span class="o">&gt;</span> <span class="err">#</span><span class="nx">ff7f0e</span>&#x000A;&#x000A;</code></pre>
        <p>To read more about Color in d3 take a look <a href="https://github.com/d3/d3-scale#category-scales">here</a>
        And learn more about scale look no <a href="#">further</a></p>
        <h3>Excercise 1</h3>
        <p>Fill the polygons with a color of your choice</p>
        <a class='jsbin-embed' href='http://jsbin.com/hexemer/embed?html,js,output'>Challenge</a>
        <a class='show-solution' data-id='solution-0' href='javascript:;'>Show solution</a>
        <div class='solution hidden' id='solution-0'>
          <pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">projection</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geoAlbers</span><span class="p">();</span>&#x000A;&#x000A;<span class="kd">var</span> <span class="nx">geoGenerator</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geoPath</span><span class="p">()</span>&#x000A;<span class="p">.</span><span class="nx">projection</span><span class="p">(</span><span class="nx">projection</span><span class="p">);</span>&#x000A;&#x000A;<span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">'#map g'</span><span class="p">)</span>&#x000A;&#x000A;<span class="nx">d3</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s1">'https://gist.githubusercontent.com/milafrerichs/12fbfb500be19a41f39a581c8285ecb0/raw/a0734d28b47d48a06ca917529369cb35d232602b/residential_and_non_residential_building_.geojson'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">json</span><span class="p">)</span> <span class="p">{</span>&#x000A;  <span class="nx">projection</span>&#x000A;  <span class="p">.</span><span class="nx">fitExtent</span><span class="p">([[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">]],</span> <span class="nx">json</span><span class="p">)</span>&#x000A;  <span class="nx">u</span> <span class="o">=</span> <span class="nx">map</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>&#x000A;  <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">json</span><span class="p">.</span><span class="nx">features</span><span class="p">);</span>&#x000A;  <span class="nx">u</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>&#x000A;  <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>&#x000A;  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'d'</span><span class="p">,</span> <span class="nx">geoGenerator</span><span class="p">)</span>&#x000A;  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span> <span class="s1">'#c0c0c0'</span><span class="p">);</span>&#x000A;<span class="p">})</span>&#x000A;&#x000A;</code></pre>
        </div>
        <h3>Excercise 2</h3>
        <p>Fill the polygons with colors based on the value of <code>YrBltRmd_n</code></p>
        <a class='jsbin-embed' href='http://jsbin.com/hexemer/embed?html,js,output'>Challenge</a>
        <a class='show-solution' data-id='solution-1' href='javascript:;'>Show solution</a>
        <div class='solution hidden' id='solution-1'>
          <pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">projection</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geoAlbers</span><span class="p">();</span>&#x000A;&#x000A;<span class="kd">var</span> <span class="nx">geoGenerator</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geoPath</span><span class="p">()</span>&#x000A;  <span class="p">.</span><span class="nx">projection</span><span class="p">(</span><span class="nx">projection</span><span class="p">);</span>&#x000A;&#x000A;<span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">'#map g'</span><span class="p">)</span>&#x000A;<span class="kd">var</span> <span class="nx">colors</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scaleOrdinal</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">schemeCategory10</span><span class="p">);</span>&#x000A;<span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scaleOrdinal</span><span class="p">([</span><span class="s1">'#fef0d9'</span><span class="p">,</span><span class="s1">'#fdd49e'</span><span class="p">,</span><span class="s1">'#fdbb84'</span><span class="p">,</span><span class="s1">'#fc8d59'</span><span class="p">,</span><span class="s1">'#e34a33'</span><span class="p">,</span><span class="s1">'#b30000'</span><span class="p">])</span>&#x000A;<span class="nx">d3</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s1">'https://gist.githubusercontent.com/milafrerichs/12fbfb500be19a41f39a581c8285ecb0/raw/a0734d28b47d48a06ca917529369cb35d232602b/residential_and_non_residential_building_.geojson'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">json</span><span class="p">)</span> <span class="p">{</span>&#x000A;  <span class="nx">projection</span>&#x000A;  <span class="p">.</span><span class="nx">fitExtent</span><span class="p">([[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">]],</span> <span class="nx">json</span><span class="p">)</span>&#x000A;  <span class="nx">u</span> <span class="o">=</span> <span class="nx">map</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>&#x000A;    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">json</span><span class="p">.</span><span class="nx">features</span><span class="p">);</span>&#x000A;  <span class="nx">u</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>&#x000A;    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>&#x000A;    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'d'</span><span class="p">,</span> <span class="nx">geoGenerator</span><span class="p">)</span>&#x000A;    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span>&#x000A;      <span class="k">return</span> <span class="nx">c</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">YrBltRmd_n</span><span class="p">);</span>&#x000A;    <span class="p">});</span>&#x000A;  <span class="p">})</span>&#x000A;&#x000A;</code></pre>
        </div>
        <h3>Excercise 3</h3>
        <p>Use topojson to create a map</p>
        <a class='jsbin-embed' href='http://jsbin.com/lisavow/embed?html,js,output'>Challenge</a>
        <a class='show-solution' data-id='solution-2' href='javascript:;'>Show solution</a>
        <div class='solution hidden' id='solution-2'>
          <pre class="highlight javascript"><code><span class="nx">overlay</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>&#x000A;<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'d'</span><span class="p">,</span><span class="nx">geoGenerator</span><span class="p">(</span><span class="nx">topojson</span><span class="p">.</span><span class="nx">feature</span><span class="p">(</span><span class="nx">points</span><span class="p">,</span> <span class="nx">points</span><span class="p">.</span><span class="nx">objects</span><span class="p">.</span><span class="nx">SnowParking</span><span class="p">)))</span>&#x000A;<span class="c1">//or</span>&#x000A;<span class="nx">overlay</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'path'</span><span class="p">).</span><span class="nx">datum</span><span class="p">(</span><span class="nx">topojson</span><span class="p">.</span><span class="nx">feature</span><span class="p">(</span><span class="nx">points</span><span class="p">,</span> <span class="nx">points</span><span class="p">.</span><span class="nx">objects</span><span class="p">.</span><span class="nx">SnowParking</span><span class="p">))</span>&#x000A;<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'d'</span><span class="p">,</span><span class="nx">geoGenerator</span><span class="p">)</span>&#x000A;<span class="c1">//or </span>&#x000A;<span class="nx">overlay</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'path'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">topojson</span><span class="p">.</span><span class="nx">feature</span><span class="p">(</span><span class="nx">points</span><span class="p">,</span> <span class="nx">points</span><span class="p">.</span><span class="nx">objects</span><span class="p">.</span><span class="nx">SnowParking</span><span class="p">).</span><span class="nx">features</span><span class="p">)</span>&#x000A;<span class="p">.</span><span class="nx">enter</span><span class="p">()</span>&#x000A;<span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"path"</span><span class="p">)</span>&#x000A;<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'d'</span><span class="p">,</span><span class="nx">geoGenerator</span><span class="p">)</span>&#x000A;&#x000A;</code></pre>
        </div>
        <h3>Excercise 4</h3>
        <p>Use a csv file to create a map</p>
        <a class='jsbin-embed' href='http://jsbin.com/tahizuf/embed?html,js,output'>Challenge</a>
        <a class='show-solution' data-id='solution-3' href='javascript:;'>Show solution</a>
        <div class='solution hidden' id='solution-3'>
          <pre class="highlight javascript"><code><span class="nx">overlay</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'path'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">points</span><span class="p">)</span>&#x000A;<span class="p">.</span><span class="nx">enter</span><span class="p">()</span>&#x000A;<span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"path"</span><span class="p">)</span>&#x000A;<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'d'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span>&#x000A;  <span class="k">return</span> <span class="nx">point</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="s2">"Point"</span><span class="p">,</span> <span class="na">coordinates</span><span class="p">:</span> <span class="p">[</span><span class="nx">d</span><span class="p">.</span><span class="nx">X</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">Y</span><span class="p">]});</span>&#x000A;<span class="p">})</span>&#x000A;&#x000A;</code></pre>
        </div>
        <a class="cta-btn" href="/mapping_with_d3_foss4g_2017/challenges/geo/projections/">Next challenge</a>
      </div>
    </section>
  </div>
</html>
